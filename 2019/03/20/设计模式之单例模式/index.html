<!DOCTYPE html>
<html>
  <!-- Html Head Tag-->
  <head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="f_x">
  <!-- Open Graph Data -->
  <meta property="og:title" content="设计模式之单例模式">
  <meta property="og:description" content="">
  <meta property="og:site_name" content="f_x&#39;s blog">
  <meta property="og:type" content="article">
  <meta property="og:image" content="http://yoursite.com">
  
    <link rel="alternate" href="/atom.xml" title="f_x&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  

  <!-- Site Title -->
  <title>f_x's blog</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <!-- Custom CSS -->
  
  <link rel="stylesheet" href="/css/style.light.css">

  <!-- Google Analytics -->
  

</head>

  <body>
    <!-- Page Header -->


<header class="site-header header-background" style="background-image: url(/img/mypicture3.jpg)">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-title with-background-image">
          <p class="title">设计模式之单例模式</p>
          <p class="subtitle"></p>
        </div>
        <div class="site-menu with-background-image">
          <ul>
            
              <li>
                <a href="/">
                  
                  Home
                  
                </a>
              </li>
            
              <li>
                <a href="/archives">
                  
                  Archives
                  
                </a>
              </li>
            
              <li>
                <a href="https://github.com/syfx">
                  
                  Github
                  
                </a>
              </li>
            
              <li>
                <a href="mailto:782933913@qq.com">
                  
                  Email
                  
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>

<article>
  <div class="container typo">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-info text-muted">
          
            <!-- Author -->
            <span class="author info">By f_x</span>
          
          <!-- Date -->
          <span class="date-time info">On
            <span class="date">2019-03-20</span>
            <span class="time">17:17:41</span>
          </span>
          
        </div>
        <!-- Tags -->
        
          <div class="post-tags text-muted">
            Tags: 

<a class="tag" href="/tags/设计模式/">#设计模式</a>


          </div>
        
        <!-- Post Main Content -->
        <div class="post-content">
          <h2 id="单例模式（Singleton-Pattern）"><a href="#单例模式（Singleton-Pattern）" class="headerlink" title="单例模式（Singleton Pattern）"></a>单例模式（Singleton Pattern）</h2><blockquote>
<p>单例模式又称<strong>单件模式/单态模式</strong>，是常用的设计模式之一。单例模式要求其实例对象只能在系统中存在一个。许多时候整个系统只需要拥有一个的全局对象，使用单例模式有利于我们协调系统整体的行为。   </p>
</blockquote>
<p><strong>单例模式三要素</strong>   </p>
<ul>
<li>必须确保一个类只有一个实例    </li>
<li>它必须自行创建这个实例    </li>
<li>必须自行向整个系统提供这个实例     </li>
</ul>
<blockquote>
<p>代码分析（c#）   </p>
</blockquote>
<pre><code>namespace Singleton
{

    /*
    空间换时间   
    声明属性时直接将它初始化   
    缺点：在没有使用时内存已经分配，（如果此单例类未被使用）就造成了空间浪费。   
    */
    class SimpleSingle
    {
        private static _mySingle = new SimpleSingle();
        public static mySingle{
            get{return _mySingle;}
        }    
    }
    /*
    饿汉式   
    时间换空间   
    缺点，因为要判断属性是否为null，因此是线程不安全的。  
    可能一个线程刚进入判断后，CPU被另外一个线程抢占而导致生成多个实例。   
    */
    class Single
    {
        private static _mySingle;
        public static mySingle{
            get{
                if(_mySingle == null)
                    _mySingle = new Single();
                return _mySingle;
            }
        }
    }

    /*
    懒汉式
    使用互斥锁保证线程安全
    */
    class MySingleton
    {
        static public Mutex mutex = new Mutex();   //创建互斥锁对象
        static private MySingleton _instance;
        static public MySingleton instance {
            get
            {
                mutex.WaitOne();            //申请互斥锁
                if (_instance == null)
                    _instance = new MySingleton();
                mutex.ReleaseMutex();       //释放锁资源
                return instance;
            }
        }

        //私有化构造函数
        private MySingleton() { }
    }
}
</code></pre><p><strong>单例模式分析</strong>   </p>
<blockquote>
<p>单例模式保证一个类仅有一个实例，并提供了一个访问它的全局访问点；单例模式拥有一个私有构造函数，确保用户不能再外界实例化它；该模式中还存在一个静态私有变量和一个静态公有工厂方法，在这个工厂方法中确保实例化自己一次，将对象保存到静态成员变量中。</p>
</blockquote>
<p><strong>单例模式的优缺点</strong>   </p>
<ul>
<li><p>优点：     </p>
<ul>
<li><strong>提供了对唯一实例的受访控制</strong>。单例类封装了它的唯一实例，所以它可以严格控制客户如何访问它。   </li>
<li><strong>节约系统资源</strong>。在系统中只存在一个对象。    </li>
<li><strong>允许可变数量的实例</strong>，可以基于单例模式进行扩展，在其工厂方法（获取实例的成员方法）中做控制以用来获取指定数目的实例。      </li>
</ul>
</li>
<li><p>缺点：      </p>
<ul>
<li><strong>单例模式在扩展时有很大的困难</strong>，因为单例模式没有抽象层（抽象父类）。</li>
<li><strong>单例类职责过重</strong>，在一定程度上违背了“单一职责原则”。它既充当了工厂角色，提供了工厂方法（获取自己的实例）；又充当了产品角色，有自己的业务逻辑；讲产品的创建与自身功能融合到了一起。      </li>
<li><strong>滥用单例时将带来一些负面问题</strong>，如为了节省资源将数据库连接池对象设计为的单例类，可能会导致共享连接池对象的程序过多而出现连接池溢出；如果实例化的对象长时间不被利用，系统会认为是垃圾而被回收（c#、Java等语言具有垃圾自动回收机制），这将导致对象状态的丢失。   </li>
</ul>
</li>
</ul>
<p><strong>适用场景</strong>   </p>
<ul>
<li>单例模式只允许创建一个对象，因此节省内存，加快对象访问速度，因此在对象需要被公用的场合适合使用。如：    <ol>
<li>需要频繁实例化然后销毁的对象。    </li>
<li>创建对象时耗时过多或者耗资源过多，但又经常用到的对象。    </li>
<li>有状态的工具类对象。     </li>
<li>频繁访问数据库或文件的对象。       </li>
</ol>
</li>
<li>单例模式的经典使用场景：   <ol>
<li>资源共享的情况下，避免由于资源操作时导致的性能或损耗等。如上述中的日志文件，应用配置。      </li>
<li>控制资源的情况下，方便资源之间的互相通信。如线程池等。   </li>
</ol>
</li>
</ul>
<p><strong>注意事项</strong>   </p>
<ol>
<li>使用时不能用反射模式创建单例，否则会实例化一个新的对象。    </li>
<li>使用饿汉单例模式时注意线程安全问题。     </li>
<li>单例模式中构造方法都是私有的，因而是不能被继承，有些单例模式可以被继承（如登记式模式）。       </li>
</ol>

        </div>
      </div>
    </div>
  </div>
</article>



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <p class="copyright text-muted">
          Theme By <a target="_blank" href="https://github.com/levblanc">Levblanc.</a>
          Inspired By <a target="_blank" href="https://github.com/klugjo/hexo-theme-clean-blog">Clean Blog.</a>
        </p><p class="copyright text-muted">
          Powered By <a target="_blank" href="https://hexo.io/">Hexo.</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    <!-- After Footer Scripts -->
<script src="/js/highlight.pack.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    var codeBlocks = Array.prototype.slice.call(document.getElementsByTagName('pre'))
    codeBlocks.forEach(function(block, index) {
      hljs.highlightBlock(block);
    });
  });
</script>

  </body>
</html>

